@using Microsoft.AspNetCore.Identity
@using SSN.Data.Models
@using SSN.Common
@model SSN.Web.ViewModels.UserAcc.UsersAccViewModel
@inject SSN.Services.Data.VoteUserService VoteUserService
@inject SSN.Services.Data.UserAccService UserAccService
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    this.ViewData["Title"] = "Doctors";
}

@* different backgound pictures for different search ...*@
@*@if (ViewBag.Specialty == "Общопрактикуващ лекар")
    {
        <style>
            body {
                background-image: url('https://www.thehealthy.com/wp-content/uploads/2017/07/This-Is-the-Day-or-Month-Youre-Most-Likely-to-Have-a-Heart-Attack_392296663-Syda-Productions-FT.jpg');
                background-repeat: no-repeat;
                background-size: cover;
            }
        </style>
    }

    @if (ViewBag.Specialty == "Pediatrics")
    {
        <style>
        body
        {
               background-image: url('https://image.freepik.com/free-vector/pediatrician-doctor-examining-little-baby_38747-400.jpg');
               background-repeat: no-repeat;
               background-size: cover;

        }
        </style>
    }
    @if (ViewBag.Specialty == "Dermatology")
    {
        <style>
        body { background-image: url('https://i1.wp.com/localemagazine.com/wp-content/uploads/2017/10/Dermatologist.jpg?resize=750%2C400&ssl=1'); background-repeat: no-repeat; background-size: cover; }
        </style>
    }*@

<style>
    input {
        box-shadow: 0 0 1px 1px black;
    }

    select {
        box-shadow: 0 0 1px 1px black;
    }

    .result {
        width: 80%;
    }

    .home-box {
        justify-content: stretch;
    }

    h5 {
        color: #274f87;
    }

    .main-card {
        width: 100%;
        height: 8rem;
        border: 1px solid #348de0;
        border-radius: 10px;
        box-shadow: 1px 3px 10px #3456e0;
        margin-bottom: 15px;
        margin-left: 50px;
        background-color: rgb(85, 237, 161, 0.1);
    }

    .doctor-card-body {
        display: flex;
        margin: 10px;
    }

    .card-image {
        width: 90%;
        height: 100%;
    }

    img {
        border-radius: 10px;
    }

    .card-picture-doc {
        width: 90%;
        height: 80%;
    }

    .card-information {
        margin: 10px 20px 10px 20px;
    }

    .card-rating {
        margin: 10px 10px 10px 10px;
        justify-content: center;
        text-align: center;
    }

    .doctor-information {
        display: flex;
        border: 1px solid black;
    }

    .doctor-comment {
        margin: 0px 0px 0px 15px;
    }

    #search-box {
        padding-right: 130px;
    }

    #image-carousel {
        width: 450px;
        height: 220px;
        border-radius: 10px;
    }

    #doctor-title {
        margin-bottom: 10px;
    }

    #doctor-city {
        margin-bottom: 10px;
    }

    #doctor-specialty {
    }

    .search-doctor, .search-region, .search-specialty {
        border-color: #348de0;
        margin: 5px;
    }

    .col-auto {
        padding: 0px;
    }
</style>

@section searchForm{
    <div class="row">
        <form method="post" asp-controller="doctors" asp-action="doctorResult">
            <div class="row">
                <div class="col-auto">
                    <div class="search-doctor">
                        <input autocomplete="off" type="text" class="form-control form-control-range border border-primary" name="search" id="search" placeholder="Име на лекар">
                    </div>
                </div>
                <div class="col-auto">
                    <div class="search-region">
                        <input autocomplete="off" type="text" class="form-control form-control-range border border-primary" name="region" id="region" placeholder="Регион">
                    </div>
                </div>
                <div class="col-auto">
                    <div class="search-specialty">
                        <select class="form-control form-control-range border border-primary" id="specialty" name="specialty">
                            <option>Specialty</option>
                            <option>Surgery</option>
                            <option>Pediatrics</option>
                            <option>Dermatology</option>
                            <option>Cardiology</option>
                            <option>Dermatologists</option>
                            <option>Общопрактикуващ лекар</option>
                            <option>Хирургия</option>
                        </select>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="search-specialty">
                        <button type="submit" class="btn btn-primary btn-group-vertical" value="Search">Търсене</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
}
<hr />
<div class="result-search">
    намерене @UserAccService.SearchCount(ViewBag.Search, ViewBag.Region, ViewBag.Specialty) резултата от 31 000
</div>
<hr />
<div class="row">
    <div class="col-md-8">
        <div class="result">
            @if ((this.ViewBag.Search == null) && (this.ViewBag.Region == null) && (this.ViewBag.Specialty == "Specialty"))
            {
                <div>
                    <h2>Не сте въвели данни в полетата за търсене</h2>
                </div>
            }
            @if ((this.ViewBag.Search != null) && (this.ViewBag.Region != null) && (this.ViewBag.Specialty != "Specialty"))
            {
                @foreach (var user in Model.Users)
                {
                    var photoPath = "~/Images/" + (user.FilePath ?? "man");

                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }
                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }
            else if ((this.ViewBag.Search != null) && (this.ViewBag.Region != null))
            {

                @foreach (var user in Model.Users)
                {
                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }
                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }
            else if ((this.ViewBag.Search != null) && (this.ViewBag.Specialty != "Specialty"))
            {
                @foreach (var user in Model.Users)
                {
                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }
                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }
            else if ((this.ViewBag.Specialty != "Specialty") && (this.ViewBag.Region != null))
            {

                @foreach (var user in Model.Users)
                {
                    var photoPath = "~/Images/" + (user.FilePath ?? "man.jpg");

                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }
                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }
            else if (this.ViewBag.Search != null)
            {

                @foreach (var user in Model.Users)
                {
                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }
                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }
            else if (this.ViewBag.Region != null)
            {

                @foreach (var user in Model.Users)
                {

                    var photoPath = "~/Images/" + (user.FilePath ?? "man");

                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" data-toggle="popover" data-trigger="focus" data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }
                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }
            else if (this.ViewBag.Specialty != "Specialty")
            {
                @foreach (var user in Model.Users)
                {
                    <div class="main-card">
                        <div class="doctor-card-body">
                            <div class="row">
                                <div class="col-2 test">
                                    @if (this.SignInManager.IsSignedIn(this.User))
                                    {
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id,true)"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a href="#" onclick="sendVote(@user.Id, false)">  <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div> 
                                            <a href="#"   data-toggle="popover" data-trigger="focus"   data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-success">  <i class="fa fa-thumbs-up"></i>&nbsp; @VoteUserService.GetVote(user.Id)</h3></a>
                                        </div>
                                        <div>
                                            <a  href="#"  data-toggle="popover" data-trigger="focus"   data-content="За да можеш да гласуваш трябва да си логнат"> <h3 class="text-danger"><i class="fa fa-thumbs-down"></i>&nbsp; @Math.Abs(VoteUserService.GetDownVote(user.Id))</h3></a>
                                        </div>

                                    }

                                    <div class="doctor-comment">
                                        <h5><i class="fas fa-comment"></i>@user.PostsCount</h5>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card-image">
                                        <a href="@user.Url"> <img class="card-picture-doc" src="~/images/blank_user.png" alt="Card image cap"></a>
                                    </div>
                                </div>
                                <div class="col-7">
                                    <h5 id="doctor-title" class="doctor-title">@user.Name</h5>
                                    <h5 id="doctor-city" class="doctor-city">@user.City</h5>
                                    <h5 id="doctor-specialty" class="doctor-specialty">@user.Specialty</h5>
                                    <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                }

            }

        </div>
    </div>

    <div class="col-md-4">
        <div class="container-fluid  ">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos1.jpg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos2.jpg" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos3.jpg" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
        <hr />
        <div class="container-fluid ">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos1.jpg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos2.jpg" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos3.jpg" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
        <hr />
        <div class="container-fluid ">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos1.jpg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos2.jpg" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" id="image-carousel" src="~/images/hos3.jpg" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>

    </div>
</div>



@*<nav aria-label="...">
        <ul class="pagination justify-content-center">
            @{
                var navigationPage = 3;
            }
            @if (this.Model.CurrentPage == 1)
            {
                <li class="page-item disabled">
                    <a class="page-link" href="#">Previous</a>
                </li>
            }
            else
            {
                <li class="page-item">
                    <a class="page-link"
                       asp-route="search"
                       asp-route-name="@this.ViewBag.Search"
                       asp-route-page="@(this.Model.CurrentPage-1)">Previous</a>
                </li>

            }

            @if (Model.CurrentPage > 6)
            {
                @for (int i = 1; i <= navigationPage; i++)
                {
                    var active = i == this.Model.CurrentPage ? "active" : string.Empty;
                    <li class="page-item  @active">
                        <a class="page-link"
                           asp-route="search"
                           asp-route-name="@this.ViewBag.Search"
                           asp-route-page="@i">@i</a>
                    </li>

                }
                <li><a class="page-link">...</a></li>
                @for (int i = Model.CurrentPage - navigationPage; i <= Model.CurrentPage + navigationPage; i++)
                {
                    var active = i == this.Model.CurrentPage ? "active" : string.Empty;
                    <li class="page-item  @active">
                        <a class="page-link"
                           asp-route="search"
                           asp-route-name="@this.ViewBag.Search"
                           asp-route-page="@i">@i</a>
                    </li>
                }
                @if (Model.CurrentPage > 7)
                {
                    <li><a class="page-link">...</a></li>
                }

            }

            @if (Model.CurrentPage < 7)
            {
                @for (int i = Model.CurrentPage; i <= Model.CurrentPage + navigationPage; i++)
                {
                    var active = i == this.Model.CurrentPage ? "active" : string.Empty;
                    <li class="page-item  @active">
                        <a class="page-link"
                           asp-route="search"
                           asp-route-name="@this.ViewBag.Search"
                           asp-route-page="@i">@i</a>
                    </li>
                }
                <li><a class="page-link">...</a></li>
            }


            @if (Model.CurrentPage + navigationPage >= Model.PagesCount)
            {

            }
            else
            {
                @for (int i = Model.PagesCount - navigationPage; i < Model.PagesCount; i++)
                {
                    var active = i == this.Model.CurrentPage ? "active" : string.Empty;
                    <li class="page-item  @active">
                        <a class="page-link"
                           asp-route="search"
                           asp-route-name="@this.ViewBag.Search"
                           asp-route-page="@i">@i</a>
                    </li>
                }
            }




            @if (Model.CurrentPage == Model.PagesCount)
            {
                <li class="page-item disabled">
                    <a class="page-link" href="#">Next</a>
                </li>
            }
            else
            {
                <li class="page-item">
                    <a class="page-link"
                       asp-route="search"
                       asp-route-name="@this.ViewBag.Search"
                       asp-route-page="@Model.CurrentPage + 1">Next</a>
                </li>
            }

        </ul>
    </nav>*@

<nav aria-label="">
    @{
        var name = "";
        var searchId = "";
    }
    @if (ViewBag.Search != null && ViewBag.Region != null && ViewBag.Specialty != null)
    {
        name = ViewBag.Search + " " + ViewBag.Region + " " + ViewBag.Specialty + " 1";
    }
    else if (ViewBag.Search != null && ViewBag.Region != null)
    {
        name = "1 " + ViewBag.Search + " " + ViewBag.Region;
    }
    else if (ViewBag.Search != null && ViewBag.Specialty != null && ViewBag.Specialty != "Specialty")
    {
        name = "2 " + ViewBag.Search + " " + ViewBag.Specialty;
    }
    else if (ViewBag.Specialty != null && ViewBag.Region != null && ViewBag.Specialty != "Specialty")
    {
        name = "3 " + ViewBag.Region + " " + ViewBag.Specialty;
    }
    else if (ViewBag.Search != null)
    {
        name = ViewBag.Search;
        searchId = "search";
    }
    else if (ViewBag.Region != null)
    {
        name = ViewBag.Region;
        searchId = "region";
    }
    else if (ViewBag.Specialty != null && ViewBag.Specialty != "Specialty")
    {
        name = ViewBag.Specialty;
        searchId = "specialty";
    }
    <ul class="pagination justify-content-center">
        @if (this.Model.CurrentPage > 1)
        {
            <li class="page-item">
                <a class="page-link" asp-route="search" asp-route-page="@Model.CurrentPage - 1" asp-route-name="@name" asp-route-searchId="@searchId" aria-label="Предишна">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
        }
        @{
            const int MorePagesToShow = 3;
            var pagesToShow = new List<int>();
            for (var i = 1; i <= MorePagesToShow; i++)
            {
                pagesToShow.Add(i);
            }
            for (var i = this.Model.CurrentPage - MorePagesToShow; i <= this.Model.CurrentPage + MorePagesToShow; i++)
            {
                if (i > 0 && i <= Model.PagesCount)
                {
                    pagesToShow.Add(i);
                }
            }
            for (var i = this.Model.PagesCount - MorePagesToShow + 1; i <= this.Model.PagesCount; i++)
            {
                if (i > 0)
                {
                    pagesToShow.Add(i);
                }
            }
            pagesToShow = pagesToShow.Where(x => x <= this.Model.PagesCount).Distinct().OrderBy(x => x).ToList();
        }
        @for (var i = 0; i < pagesToShow.Count; i++)
        {
            var className = string.Empty;
            var pageNumber = pagesToShow[i];
            if (pageNumber == this.Model.CurrentPage)
            {
                className = "active";
            }
            if (i > 0 && pageNumber - 1 != pagesToShow[i - 1])
            {
                <li class="page-item @className"><a class="page-link" asp-route="search" asp-route-page="@(pagesToShow[i - 1] + 1)" asp-route-name="@name" asp-route-searchId="@searchId">...</a></li>
            }
            <li class="page-item @className"><a class="page-link" asp-route="search" asp-route-page="@pageNumber" asp-route-name="@name" asp-route-searchId="@searchId">@pageNumber</a></li>
        }
        @if (this.Model.CurrentPage < this.Model.PagesCount)
        {
            <li class="page-item">
                <a class="page-link" asp-route="search" asp-route-page="@Model.CurrentPage + 1" asp-route-name="@name" asp-route-searchId="@searchId" aria-label="Следваща">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        }
    </ul>
</nav>

<script>
    function sendVote(userAccId, isUpVote) { 
        var token = $("#votesForm input[name=__RequestVerificationToken]").val();
        var json = { userAccId: userAccId, isUpVote: isUpVote };
        console.log(json);
        $.ajax({
            url: "/api/votes",
            type: "POST",
            data: JSON.stringify(json),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            headers: { 'X-CSRF-TOKEN': token },
            success: function (data) {
                $("#votesCount").html(data.votesCount);
            }
        });
    }
</script>
